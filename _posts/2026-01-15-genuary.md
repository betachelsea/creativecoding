---
layout: work
title:  "Shadows"
date:   2026-01-01 00:00:00 +0900
desc: "Create an invisible object where only the shadows can be seen. #genuary 2026"
---

<script type="text/ruby">
CANVAS_HEIGHT = 750
CANVAS_WIDTH = 750

BALL_NUMBER = 8
BALL_X = 200
FLOOR_Y = 400
RADIUS = 60

FRAMERATE = 60
H = 300 # 跳ねる高さ
OMEGA = (Math::PI * 2) / 3.0 # 1.5秒で1バウンス # 混乱するので整理

class Ball
  attr :h
  attr :x

  def initialize
    @x = rand(-100..(CANVAS_WIDTH)+100)
    @h = rand(100..400)
    @d_pi = rand(0.0..1.0)
  end

  def draw_shadow(phase)
    strokeWeight(0);

    phase = phase + (Math::PI * @d_pi)
    phase %= (Math::PI * 2)
    u = Math.sin(phase).abs
    h = @h * (u ** 0.7) # h = H * (u ** 0.7)
    hn = h / @h # hn = h / H

    shadow_scale = lerp(0.4, 1.6, hn ** 0.8)

    blur = lerp(2, 8, (hn ** 1.0)) # 2〜8の数値をhnに応じて計算
    drawingContext.filter = "blur(#{blur}px)"
    alpha = lerp(0.35, 0.1, (hn ** 1.2))
    fill("rgba(0,0,0,#{alpha})")
    ellipse(@x, FLOOR_Y, (RADIUS * 1.6) * shadow_scale, (RADIUS * 1.0) * shadow_scale); # 影3

    fill("red")
    drawingContext.filter = "none";
    # ellipse(@x, FLOOR_Y - h, RADIUS * 2, RADIUS * 2)
    @x = @x + 3
    if CANVAS_WIDTH + 100 < @x
      @x = -100
    end
  end
end

def setup
  createCanvas(CANVAS_WIDTH, CANVAS_HEIGHT)
  frameRate(FRAMERATE)
  $phase = 0
  $base_x = 0
  $balls = BALL_NUMBER.times.map { Ball.new }
end

def lerp(a, b, t) # 線形補間
  a + (b - a) * t
end


def draw
  clear
  dt = deltaTime / 1000.0 # milliseconds
  $phase += dt * OMEGA
  $phase %= (Math::PI * 2) # 2πを超えないようにする
  $base_x += 3
  $base_x %= CANVAS_WIDTH
  $balls.each do |ball|
   ball.draw_shadow($phase)
  end
end

P5::init()
</script>
